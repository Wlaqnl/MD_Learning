## 7장 이미지와 딥러닝

`목표`  딥러닝이 많이 활용되는 이미지 처리를 중심으로 딥러닝을 살펴보고 인터넷에서 가져온 이미지를 어떻게 머신러닝에 활용할 수 있는지, 어떻게 튜닝하는지 등을 확인해보기



### 7-1 유사 이미지 검출하기

> ### Averagee Hash - 간단한 형태 인식

* **이미지를 비교 가능한 해시 값으로 나타낸 것**
* 해시 함수 MD5, SHA256 등을 이용하면 데이터 값을 간단한 해시 값으로 변환할 수 있고, 이러한 해시 값을 기반으로 같은 데이터를 검출할 수 있다.
* 하지만 이미지가 비슷한지 등을 검출할 때 MD5와 SHA256등의 해시 함수를 사용하면 안 된다.
* 완전한 동일한 바이너리를 찾을 때는 해시 함수를 사용하지만 이미지 데이터는 이미지 해상도 크기 조정, 색조 보정, JPEG/PNG 등의 압축 형식 변경 등을 하기 때문에 완전히 같은 바이너리를 찾는 것이 의미 없기 때문이다.
* 이미지가 조금 다르더라도 유사한지를 검출해야 할 때 사용한다.
* 방법
  * 이미지 크기를 8*8로 축소한다.
  * 색을 그레이스케일로 변환한다.
  * 이미지 각 픽셀의 평균을 계산한다.
  * 각 픽셀의 어두운 정도가 평균보다 크면 1, 평균보다 작으면 0으로 입력한다.
    * **즉, 리사이즈하고 이진화하기만 하면 되는 간단한 처리**
    * 위와 같은 간단한 방법으로 이미지의 형태를 나타나는 64비트 해시 값을 구할 수 있어서 64비트를 비교하기만 하면 빠르게 유사한 이미지를 검색할 수 있다.





> ### 해밍 거리(Hamming distance)

* 같은 문자 수를 가진 2개의 문자열에서 대응하는 위치에 있는 문자 중 다른 것의 개수를 나타낸다.
* 몇 글자가 다른지 찾고, 이를 기반으로 이미지의 차이를 구분하는 것





### 7-2 CNN으로 Caltech 101의 이미지 분류하기

> ### 정밀도를 높이는 방법

* 샘플을 늘리기 위해 이미지의 각도를 약간 바꾸거나, 반전하거나, 확대/축소하거나, 평균화하거나, 노이즈를 넣거나, 명암 대비와 같은 감마값을 바꾼 이미지를 만들어 사용하는 것
* 의미가 없을 것 같지만 정말 효과적인 방법



> ### 이미지의 수를 늘릴 때 활용할 수 있는 PIL 메서드
>
> * Image.transpose(v) : 90도 단위로 이미지를 회전하거나 반전
>
> * Image.rotate(angle) : 이미지를 angle도만큼 회전





### 7-3 규동 메뉴 이미지 판정하기

> ### **데이터의 정밀도를 높이기 위해 데이터의 수를 늘리는데 제대로 처리하는 방법**

* 이미지 파일을 모두 읽는다.
* 섞은 뒤에 훈련 데이터와 테스트 데이터를 구분한다.
* 훈련 데이터를 가지고 수평 반전 등을 해서 학습 정밀도를 높인다.





### 7-4 OpenCV로 얼굴 인식하기

> ### OpenCV

* **Open Source Computer Vision Library**로 오픈소스 이미지 처리 라이브러리
* 이미지 처리, 구조 분석, 패턴 인식, 머신러닝을 활용한 이미지와 동영상 처리 등의 다양한 기능을 지원한다.
* BSD라이언스로 배포되고 있으므로 상업적인 용도로도 사용할 수 있다.
* 배열 형태로 이미지의 일부분을 잘라낼 수 있다.
* 이미지 데이터가 Numpy 형식이므로 쉽게 값을 설정하거나 추출할 수 있다.





### 7-5 이미지 OCR - 연속된 문자 인식하기

* cv2.findContours() 함수는 이미지 속의 이미지를 검출하며, 계층 구조를 가진 윤곽도 추출할 수 있는 굉장히 뛰어난 기능을 가지고 있다.
* OpenCV를 이용하면 **문자 영역**을 인식할 수 있다.
* 손으로 직접 작성한 이미지 세트가 적은 경우에도 데이터를 회전하거나 수평 정렬해서 늘려 사용하면 딥러닝의 정밀도를 올릴 수 있다.