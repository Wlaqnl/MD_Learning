## 4장 머신러닝

`목표`  머신러닝이 무엇이고 어떻게 하는지 살펴보기



### 4-1 머신러닝이란?

> ### 머신러닝

* 인공지능 연구 과제 중의 하나, 인간의 뇌가 자연스럽게 수행하는 학습이라는 능력을 컴퓨터로 구현하는 방법
* 수많은 데이터를 학습시켜 거기에 있는 **패턴**을 찾아내는 것
* 어느 정도 규모가 있는 샘플 데이터를 입력으로 넣어 분석시켜 데이터에서 일정한 **규칙**을 찾아낸다. 그 찾아낸 규칙을 기반으로 다른 **데이터를 분류하거나 미래를 예측하는 것**
* **벡터**가 중요함

* 종류
  * **교사 학습** : 선생님이 옆에서 문제를 주고, 답을 알려주는 것과 같은 학습 방법
    * 새로운 글자 이미지를 줬을 때 해당 이미지에 어떤 글자가 적혀있는지 예측할 수 있다.
  * **비교사 학습** : 최종적으로 내야 하는 답이 정해져 있지 않다는 것이 교사 학습과 다른 부분
    * 예 : 클러스터 분석, 주성분 분석, 벡터 양자화, 자기 조직화 등
  * **강화 학습** : 현재 상태를 관찰해서 어떻게 대응해야 할지와 관련된 문제를 다루며 교사가 완전한 답을 제공하지는 않는다.
    * 행동의 주체 - 환경을 관찰하고 이를 기반으로 의사결정을 내려 행동한다.
    * 환경 - 환경이 변화하면서 행동의 주체가 어떤 보상을 받는다.
    * 이를 기반으로 행동의 주체는 더 많은 보상을 얻을 수 있는 방향으로 행동을 학습하게 된다.
* 과정
  * 데이터 수집
  * 데이터 가공
  * 데이터 학습 (학습 방법 선택, 매개 변수 조정, 모델 학습)
  * 모델 평가
  * 정밀도 제대로 나오는지 평가
* 응용 분야
  * 클래스 분류 - 특정 데이터에 레이블을 붙여 분류할 수 있다.
  * 클러스터링(그룹 나누기) - 값의 유사성을 기반으로 데이터를 여러 그룹으로 나눌 수 있다.
  * 추천 - 특정 데이터를 기반으로 다른 데이터를 추천하는 것
  * 회귀 - 과거의 데이터를 기반으로 미래의 데이터를 예측하는 것
  * 차원 축소 - 데이터의 특성을 유지하면서 데이터의 양을 줄이는 것



> ### 특징 추출

* 머신러닝을 위해 데이터가 어떤 특징을 가지고 있는지 찾고 **벡터로 만드는 변환 처리**



> ### 회귀 분석

* 통계 용어인데, Y가 연속된 값일 때 Y=f(x)와 같은 모델로 나타내는 것
* 선형 회귀 : Y = aX+b (가장 기본적인 모델)



> ### 초과학습(Overfitting)

* 훈련 전용 데이터가 학습돼 있지만 학습되지 않은 새로운 데이터에 대해 제대로 된 예측을 못하는 상태를 의미한다.
* 원인
  * 데이터가 너무 적은 경우
  * 모델에 비해 문제가 너무 복잡한 경우





### 4-2 머신러닝 첫걸음

> ### scikit-learn

* 머신러닝 프레임워크(특정 프로그램을 개발하기 위한 여러 요소들과 매뉴얼인 룰을 제공하는 프로그램)
* 파이썬 머신러닝 라이브러리의 정석과도 같은 라이브러리(소프트웨어를 개발하기 쉽게 어떤 기능을 제공하는 도구들)
* 다양한 분류기를 지원하며, 머신러닝의 결과를 검증하는 기능도 가지고 있다.
* 분류, 회귀, 클러스터링, 차원 축소처럼 머신러닝에서 자주 사용되는 다양한 알고리즘을 지원한다.
* 머신러닝을 바로 테스트해볼 수 있게 샘플 데이터도 제공한다.
* fit() 메서드 - 학습 기계에 데이터를 학습시킨다.
* predict() 메서드 - 데이터를 넣어 예측시킨다.
* train_test_split() 메서드 - 훈련 전용 데이터와 학습 전용 데이터를 분할한다.



> ### XOR

* 두 입력 중 하나만 참이고 다른 한 쪽이 거짓일 때 참이 나온다.





### 4-3 이미지 내부의 문자 인식

* 손글씨 데이터 MNIST는 머신러닝 예제로 유명하다.
* 머신러닝의 결과를 확인하려면 훈련 데이터로 사용하지 않은 테스트 데이터를 사용해야 한다.





### 4-4 외국어 문장 판별하기

* 글자를 곧바로 학습기에 넣을 수 없기 때문에 글자 데이터를 나타내는 벡터로 변경해서 사용해야 한다.
* 정규화 : 데이터를 일정한 규칙을 기반으로 변형해서 쉽게 사용할 수 있게 하는 것
* **mataplotlib** : 수학 계산 전용 라이브러리 NumPy와 함께 사용하는 그래프 그리기 라이브러리
* **pandas** : 데이터 분석을 해주는 라이브러리





### 4-5 서포트 벡터 머신(SVM)

> ### SVM(Support Vector Machine)

* 선을 구성하는 매개변수를 조정해서 요소들을 구분하는 **선**을 찾고, 이를 기반으로 **패턴**을 인식하는 방법
* 머신러닝 방법 중 하나
* 식별 평면 : 패턴의 경계가 되는 것
* 마진 최대화 : 식별 평면에서 패턴들과의 거리를 **최대**로 만드는 것 - 가장 좋은 결과
* 일반화 능력 : 알 수 없는 패턴도 SVM을 이용하면 제대로 분류할 확률이 굉장히 높다.
* scikit-learn에서는 세 가지 종류의 SVM을 지원
  * SVC, NuSVC : 표준적으로 구현된 SVM으로 오류 처리 방법이 약간 다르지만 수학적으로 같다.
  * LinearSVC : 선형 커널 특화된 SVM으로 계산이 빠르며, 다양한 옵션을 가지고 있다.





### 4-6 랜덤 포레스트

> ### 랜덤 포레스트

* 학습 전용 데이터를 샘플링해서 여러 개의 의사결정 트리(예측과 분류를 수행하는 알고리즘 자체)를 만들고, 만들어진 의사결정 트리를 기반으로 다수결로 결과를 결정하는 방법
* 머신러닝에서 자주 사용되는 알고리즘
* 집단 학습을 기반으로 고정밀 분류, 회귀, 클러스터링 등을 구현하는 것
* 처리가 빠르고 분류 정밀도가 높다.
* scikit-learn으로 사용할 수 있다.
* 데이터를 숫자로 변경할 때는 분류 변수인지 연속 변수인지를 생각해야 한다.





### 4-7 데이터를 검증하는 방법

> ### 크로스 밸리데이션(Cross-validation) - 교차 검증

* 특정 데이터를 **훈련 전용 데이터**와 **테스트 전용 데이터**로 **분할**한 뒤 훈련 데이터를 활용해 학습하고, 테스트 데이터로 테스트해서 **학습의 타당성을 검증**하는 방법
  * ex) K 분할 교차 검증(K-fold cross validation)
* model_selection.cross_val_score() 메서드 사용
* 결과는 배열(numpy.ndarray)로 리턴되므로 평균을 쉽게 계산해서 출력할 수 있다.



> ### 그리드 서치(Grid Search)

* 각 매개 변수를 적당한 범위 내부에서 변경하면서 가장 성능이 좋을 때의 값을 찾는 방법
* GridSearchCV() 메서드 사용
* 적절한 매개변수를 지정하면 정답률이 굉장히 올라가기 때문에 **매개변수 튜닝**은 굉장히 중요한 작업이다.
* 하지만 처리하는데 시간이 꽤 오래 걸린다.